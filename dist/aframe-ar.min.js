!function(t){function e(a){if(i[a])return i[a].exports;var r=i[a]={exports:{},id:a,loaded:!1};return t[a].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){i(4),i(3),i(2),i(1)},function(t,e){AFRAME.registerComponent("ar-raycaster",{dependencies:["raycaster"],schema:{x:{default:.5},y:{default:.5},el:{type:"selector"}},init:function(){this.raycaster=this.el.components.raycaster.raycaster,this.raycasterIntersectObjects=this.raycaster.intersectObjects.bind(this.raycaster),this.raycaster.intersectObjects=this.intersectObjects.bind(this)},update:function(t){this.data.el||this.el.sceneEl.object3D.el||(this.el.sceneEl.object3D.el=this.el.sceneEl)},intersectObjects:function(t,e){return this.raycasterIntersectObjects(t,e).concat(this.hitAR())},hitAR:function(){var t=new THREE.Matrix4,e=new THREE.Vector3,i=new THREE.Quaternion,a=new THREE.Vector3;return function(){var r=this.el.sceneEl.components["three-ar"];if(!r||!r.arDisplay||!r.arDisplay.hitTest)return[];var n=r.arDisplay.hitTest(this.data.x,this.data.y);return!n||n.length<=0?[]:(t.fromArray(n[0].modelMatrix),t.decompose(e,i,a),[{distance:e.distanceTo(this.el.object3D.position),point:e,object:this.data.el&&this.data.el.object3D||this.el.sceneEl.object3D}])}}()})},function(t,e){AFRAME.registerComponent("ar",{dependencies:["three-ar-planes"],init:function(){this.el.sceneEl.setAttribute("vr-mode-ui",{enabled:!1})}})},function(t,e){AFRAME.registerComponent("three-ar-planes",{dependencies:["three-ar"],init:function(){this.planes=new Map},tick:function(t,e){var i=this.el.components["three-ar"];if(i&&i.arDisplay){var a=i.arDisplay.anchors_;if(a){this.tempPosition||(this.tempPosition=new THREE.Vector3),this.tempQuaternion||(this.tempQuaternion=new THREE.Quaternion),this.tempScale||(this.tempScale=new THREE.Vector3),this.tempRotation||(this.tempRotation=new THREE.Euler(0,0,0,"YXZ")),this.tempMatrix4||(this.tempMatrix4=new THREE.Matrix4);for(var r=0;r<a.length;r++){var n=a[r];this.tempMatrix4.elements=n.transform,this.tempMatrix4.decompose(this.tempPosition,this.tempQuaternion,this.tempScale),this.tempRotation.setFromQuaternion(this.tempQuaternion),this.planes[n.identifier]?(AFRAME.utils.deepEqual(n,this.planes[n.identifier])||(this.planes[n.identifier]=n,this.el.emit("updateplane",{id:n.identifier,alignment:n.alignment,extent:{x:n.extent[0],y:0,z:n.extent[1]},position:this.tempPosition,rotation:{x:THREE.Math.RAD2DEG*this.tempRotation.x,y:THREE.Math.RAD2DEG*this.tempRotation.y,z:THREE.Math.RAD2DEG*this.tempRotation.z},scale:{x:1,y:1,z:1}})),this.planes[n.identifier].marked=!0):(this.planes[n.identifier]=n,this.planes[n.identifier].marked=!0,this.el.emit("createplane",{id:n.identifier,alignment:n.alignment,extent:{x:n.extent[0],y:0,z:n.extent[1]},position:this.tempPosition,rotation:{x:THREE.Math.RAD2DEG*this.tempRotation.x,y:THREE.Math.RAD2DEG*this.tempRotation.y,z:THREE.Math.RAD2DEG*this.tempRotation.z},scale:{x:1,y:1,z:1}}))}this.planes.forEach(function(t,e,i){var a=this.planes[t];a.marked?a.marked=!1:(this.el.emit("removeplane",{id:a.identifier}),delete this.planes[t])})}}}})},function(t,e){AFRAME.registerComponent("three-ar",{schema:{takeOverCamera:{default:!0}},init:function(){this.el.sceneEl.hasLoaded?this.onceSceneLoaded():this.el.sceneEl.addEventListener("loaded",this.onceSceneLoaded.bind(this))},tick:function(t,e){if(this.arDisplay&&this.arDisplay.getFrameData&&(this.arView&&this.arView.render(),this.arCamera)){var i=this.arCamera;this.frameData||(this.frameData=new VRFrameData),this.arDisplay.getFrameData(this.frameData);var a=this.frameData.pose.position;i.el.setAttribute("position",{x:a[0],y:a[1],z:a[2]}),this.poseEuler||(this.poseEuler=new THREE.Euler(0,0,0,"YXZ")),this.poseQuaternion||(this.poseQuaternion=new THREE.Quaternion);var r=this.frameData.pose.orientation;this.poseQuaternion.set(r[0],r[1],r[2],r[3]),this.poseEuler.setFromQuaternion(this.poseQuaternion),i.el.setAttribute("rotation",{x:THREE.Math.RAD2DEG*this.poseEuler.x,y:THREE.Math.RAD2DEG*this.poseEuler.y,z:THREE.Math.RAD2DEG*this.poseEuler.z}),i.projectionMatrix.fromArray(this.frameData.leftProjectionMatrix)}},takeOverCamera:function(t){this.arCamera=t,t.isARPerspectiveCamera=!0,t.vrDisplay=this.arDisplay,t.el.setAttribute("look-controls",{enabled:!1})},onceSceneLoaded:function(){var t=this;THREE.ARUtils.getARDisplay().then(function(e){if(t.arDisplay=e,e){var i=t.el.sceneEl;t.data.takeOverCamera&&setTimeout(function(){t.takeOverCamera(i.camera)}),i.renderer.alpha=!0,i.renderer.autoClearColor=THREE.ARUtils.isARKit(e),i.renderer.autoClearDepth=!0,t.arView=new THREE.ARView(e,i.renderer)}})},getProjectionMatrix:function(){return this.arDisplay&&this.arDisplay.getFrameData?(this.frameData||(this.frameData=new VRFrameData),this.arDisplay.getFrameData(this.frameData),this.frameData.leftProjectionMatrix):null}})}]);